#### 流式数据

**有界流**：数据存在边界的流，有来世有结束，能计算

​			  例如，内存中的数据流：集合

​						 磁盘中的数据流：文件

**无界流**：数据不存在边界的流，有开始没有结束，无法计算

​				例如，网络数据流：socket

​				消息队列：kafka

为了能够计算，把无界数据切分成有界的数据

数据量大，计算延迟高为离线处理，延迟低为实时处理

SparkStreaming是一个微批次，准实时数据处理框架

微批次：按时间切分无界数据，形成有界数据，

准实时：切分无界数据的时间一般以秒为单位，然后把采集的数据封装成离散化流数据模型，			  再转成RDD发送到Driver执行

bin/kafka-console-producer.sh --broker-list hadoop102:9092 --topic sparks

treaming

#### Dstream-Transform

Dstream类似RDD，它也可以封装计算逻辑，具体执行还是底层的RDD

数据操作过程中存在状态的概念，数据处理中如果将数据结果保存下来。就叫做有状态，不保存叫做无状态，例如处理不同一批次数据不把结果累加

Transform使用场景：

DStream本身的转换原语比较有限， 当功能不满足时需要利用transform原语转换为RDD，

​														当Driver端周期性执行代码逻辑时使用

**join**  将相同的key的value归并在一起



**有状态**

1）有状态数据必须为k-v类型，需要设置检查点

2）updatestateByKey可以实现有状态操作，需要传递参数（Seq1，option1）=> option2，这里Seq为相同key的value的集合，option1为更新状态前的缓冲区，option2为更新状态后的缓冲区

#### 窗口window

**窗口的范围大小必须是采集范围的整数倍**

窗口操作中，当前窗口范围内的数据计算玩完后，窗口会滑动一次，默认滑动幅度为一个采集周期，滑动一次计算一次

另外，滑动幅度可以大于一个采集周期，但是必须为 采集周期的整数倍，且修改幅度后，计算周期也会变化

**窗口范围和滑动幅度的关系：**

  1. 如果窗口滑动幅度小于窗口范围，计算时会有重复数据

     优化：当窗口滑动时，减去移出的数据，增加移入的数据

     ​		  reduceByKeyAndwindow(移入的数据处理，移出的数据处理，窗口范围，窗口的滑动幅度)

     

  2. 如果窗口滑动幅度等于窗口范围，计算时不会有重复数据

     

  3. 如果窗口滑动幅度大于窗口范围，计算时会丢失数据

离散化流输出时，本身自带的输出原语比较少，所以一般把离散化流转换为RDD输出

**sparkstreaming使用的分区是kafka的分区**